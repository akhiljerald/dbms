SELECT * FROM AUTHOR
WHERE AUTHORID IN (SELECT AUTHORID FROM CATALOG
GROUP BY AUTHORID
HAVING COUNT(*) >2 AND AUTHORID IN(SELECT AUTHORID FROM CATALOG
WHERE (PRICE >
(SELECT AVG(PRICE) FROM CATALOG) AND YEAR>=2000)));


SELECT name FROM author a,catalog c WHERE a.authorid=c.authorid AND
bookid IN (SELECT bookid FROM order_details WHERE quantity= (SELECT MAX(quantity) FROM order_details));


SELECT BOOKID, TITLE, PRICE, PRICE*1.1 FROM CATALOG;


CREATE TABLE AUTHOR (AUTHORID INT,
NAME VARCHAR(20), CITY VARCHAR(20),
COUNTRY VARCHAR(15), PRIMARY KEY(AUTHORID));

CREATE TABLE PUBLISHER (PUBLISHERID INT,
NAME VARCHAR(20), CITY VARCHAR(20), COUNTRY VARCHAR(15),
PRIMARY KEY(PUBLISHERID));

CREATE TABLE CATEGORY (CATEGORYID INT, DESCRIPTION VARCHAR(20), PRIMARY KEY(CATEGORYID));

CREATE TABLE CATALOG (BOOKID INT,
TITLE VARCHAR(20), AUTHORID INT, PUBLISHERID INT, CATEGORYID INT, YEAR INT,
PRICE INT,
PRIMARY KEY(BOOKID),
FOREIGN KEY(AUTHORID) REFERENCES AUTHOR(AUTHORID), FOREIGN KEY(PUBLISHERID) REFERENCES PUBLISHER(PUBLISHERID), FOREIGN KEY(CATEGORYID) REFERENCES CATEGORY(CATEGORYID));

CREATE TABLE ORDER_DETAILS (ORDERNO INT,
BOOKID INT, QUANTITY INT,
PRIMARY KEY(ORDERNO,BOOKID),
FOREIGN KEY(BOOKID) REFERENCES CATALOG(BOOKID));



INSERT INTO AUTHOR VALUES(1,'NAME1','BANGALORE','INDIA'); 
INSERT INTO AUTHOR VALUES(2,'NAME2','BANGALORE','INDIA'); 
INSERT INTO AUTHOR VALUES(3,'NAME3','BANGALORE','INDIA'); 
INSERT INTO AUTHOR VALUES(4,'NAME4','BANGALORE','INDIA');
INSERT INTO AUTHOR VALUES(5,'NAME5','BANGALORE','INDIA');

INSERT INTO PUBLISHER VALUES(1,'TITLE1','BANGALORE','INDIA'); 
INSERT INTO PUBLISHER VALUES(2,'TITLE2','BANGALORE','INDIA'); 
INSERT INTO PUBLISHER VALUES(3,'TITLE3','BANGALORE','INDIA');
INSERT INTO PUBLISHER VALUES(4,'TITLE4','BANGALORE','INDIA'); 
INSERT INTO PUBLISHER VALUES(5,'TITLE5','BANGALORE','INDIA');

INSERT INTO CATEGORY VALUES(1,'BRAVE'); 
INSERT INTO CATEGORY VALUES(2,'STORY');
INSERT INTO CATEGORY VALUES(3,'THRILL'); 
INSERT INTO CATEGORY VALUES(4,'MAN'); 
INSERT INTO CATEGORY VALUES(5,'PLAY');

INSERT INTO CATALOG VALUES(1,'BOOK1',1,1,1,2020,70); 
INSERT INTO CATALOG VALUES(2,'BOOK2',1,2,2,2020,80); 
INSERT INTO CATALOG VALUES(3,'BOOK3',1,3,3,2020,90); 
INSERT INTO CATALOG VALUES(4,'BOOK4',3,4,4,2020,10); 
INSERT INTO CATALOG VALUES(5,'BOOK5',3,5,5,2020,60); 

INSERT INTO ORDER_DETAILS VALUES(5,11,130); 
INSERT INTO ORDER_DETAILS VALUES(1,12,110); 
INSERT INTO ORDER_DETAILS VALUES(2,13,230); 
INSERT INTO ORDER_DETAILS VALUES(3,14,190); 
INSERT INTO ORDER_DETAILS VALUES(4,15,380);

