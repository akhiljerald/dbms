SELECT CUSTOMER_NAME FROM DEPOSITOR
WHERE ACCNO IN(SELECT ACCNO FROM DEPOSITOR
WHERE ACCNO IN( SELECT ACCNO FROM ACCOUNT
WHERE BRANCH_NAME IN(SELECT BRANCH_NAME FROM ACCOUNT
WHERE BRANCH_NAME='MAIN BRANCH' GROUP BY BRANCH_NAME
HAVING COUNT(*) > 1) ))
GROUP BY CUSTOMER_NAME HAVING COUNT(*) > 1;


SELECT CUSTOMER_NAME
FROM BRANCH B,ACCOUNT A,DEPOSITOR D
WHERE B.BRANCH_NAME=A.BRANCH_NAME AND A.ACCNO=D.ACCNO AND B.BRANCH_CITY='CITY6' GROUP BY CUSTOMER_NAME
HAVING COUNT(DISTINCT B.BRANCH_NAME)=(SELECT COUNT(BRANCH_NAME) FROM BRANCH
WHERE BRANCH_CITY='CITY6');


DELETE FROM ACCOUNT
WHERE BRANCH_NAME IN (SELECT BRANCH_NAME FROM BRANCH
WHERE BRANCH_CITY='CITY6');



CREATE TABLE BRANCH
(BRANCH_NAME VARCHAR(20) PRIMARY KEY, BRANCH_CITY VARCHAR(10),
ASSETS REAL);

CREATE TABLE ACCOUNT (ACCNO INT PRIMARY KEY, BRANCH_NAME VARCHAR(20), BALANCE REAL,
FOREIGN KEY(BRANCH_NAME) REFERENCES BRANCH(BRANCH_NAME));

CREATE TABLE CUSTOMER
(CUSTOMER_NAME VARCHAR(20) PRIMARY KEY, CUSTOMER_STREET VARCHAR(20),
CUST_CITY VARCHAR(20));

CREATE TABLE DEPOSITOR (CUSTOMER_NAME VARCHAR(20), ACCNO INT,
PRIMARY KEY(CUSTOMER_NAME,ACCNO),
FOREIGN KEY(CUSTOMER_NAME) REFERENCES CUSTOMER(CUSTOMER_NAME), FOREIGN KEY(ACCNO) REFERENCES ACCOUNT(ACCNO)ON DELETE CASCADE);

CREATE TABLE  LOAN (LOAN_NO INT PRIMARY KEY, BRANCH_NAME VARCHAR(20), AMOUNT REAL,
FOREIGN KEY(BRANCH_NAME) REFERENCES BRANCH(BRANCH_NAME));

CREATE TABLE BORROWER (CUSTOMER_NAME VARCHAR(20), LOAN_NO INT,
FOREIGN KEY(CUSTOMER_NAME) REFERENCES CUSTOMER(CUSTOMER_NAME), FOREIGN KEY(LOAN_NO) REFERENCES LOAN(LOAN_NO));


INSERT INTO BRANCH VALUES('BRANCH1','CITY1',1000); 
INSERT INTO BRANCH VALUES('BRANCH2',' CITY2',2000); 
INSERT INTO BRANCH VALUES('BRANCH3',' CITY3',3000);
INSERT INTO BRANCH VALUES('BRANCH4',' CITY4',3000); 
INSERT INTO BRANCH VALUES('BRANCH5',' CITY5',2000);
INSERT INTO BRANCH VALUES('MAIN BRANCH',' CITY6' ,2000); 
INSERT INTO BRANCH VALUES('BRANCH6','CITY6' ,2000);
INSERT INTO BRANCH VALUES('BRANCH7','CITY6' ,2000); 
INSERT INTO BRANCH VALUES('BRANCH8','CITY6' ,2000);

INSERT INTO ACCOUNT VALUES(9,'BRANCH8',15000);
INSERT INTO ACCOUNT VALUES(8,'BRANCH7',15000); 
INSERT INTO ACCOUNT VALUES(7,'BRANCH6',15000);
INSERT INTO ACCOUNT VALUES(6,'MAIN BRANCH',15000); 
INSERT INTO ACCOUNT VALUES(5,'MAIN BRANCH',50000); 
INSERT INTO ACCOUNT VALUES(4,'MAIN BRANCH',30000); 
INSERT INTO ACCOUNT VALUES(3,'BRANCH3',30000);
INSERT INTO ACCOUNT VALUES(2,'BRANCH2',20000); 
INSERT INTO ACCOUNT VALUES(1,'BRANCH1',10000);

INSERT INTO CUSTOMER VALUES ('NAME1', 'A STREET', 'CITY6'); 
INSERT INTO CUSTOMER VALUES ('NAME2', 'B STREET', 'CITY6'); 
INSERT INTO CUSTOMER VALUES ('NAME3', 'C STREET', 'CITY6'); 
INSERT INTO CUSTOMER VALUES ('NAME4', 'D STREET', 'CITY6');
INSERT INTO CUSTOMER VALUES ('NAME5', 'E STREET', 'CITY6');

INSERT INTO DEPOSITOR VALUES('NAME1',1); 
INSERT INTO DEPOSITOR VALUES('NAME1',9); 
INSERT INTO DEPOSITOR VALUES('NAME2',1);
INSERT INTO DEPOSITOR VALUES('NAME3',1);
INSERT INTO DEPOSITOR VALUES('NAME4',1); 
INSERT INTO DEPOSITOR VALUES('NAME4',9); 
INSERT INTO DEPOSITOR VALUES('NAME4',5); 
INSERT INTO DEPOSITOR VALUES('NAME4',6); 
INSERT INTO DEPOSITOR VALUES('NAME4',7); 
INSERT INTO DEPOSITOR VALUES('NAME4',8);
INSERT INTO DEPOSITOR VALUES('NAME5',1);

INSERT INTO LOAN VALUES(7,'BRANCH8', 1000); 
INSERT INTO LOAN VALUES(6,'BRANCH7', 1000); 
INSERT INTO LOAN VALUES(5,'BRANCH6', 1000); 
INSERT INTO LOAN VALUES(4,'BRANCH6', 1000);
INSERT INTO LOAN VALUES(3,'MAIN BRANCH', 1000);
INSERT INTO LOAN VALUES(2,'MAIN BRANCH', 10000); 
INSERT INTO LOAN VALUES(1,'MAIN BRANCH', 10000);

INSERT INTO BORROWER VALUES('NAME1', 1); 
INSERT INTO BORROWER VALUES('NAME2', 2); 
INSERT INTO BORROWER VALUES('NAME3', 3); 
INSERT INTO BORROWER VALUES('NAME4', 4); 
INSERT INTO BORROWER VALUES('NAME2', 5);



